---
title: "Biostatistics"
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
description: >
  Review of t-tests and ANOVAs in a stream ecology context.
---

```{r setup, include=FALSE}

library(learnr)
library(tidyverse)

algae <- read_csv('./data/week2_algae.csv') %>% 
  gather(key = stream_type, value = algal_biomass)

tutorial_options(exercise.timelimit = 10)

```

## Introduction

Review of t-tests and ANOVAs in a stream ecology context.

### Outline

Here we will learn some stats. Yay!

What we will cover:

* Intro to biostats
* t-tests
* ANOVAs

## Statistics

### Why do we need statistics?

Imagine we are hiking through the Sierras and we notice that some streams have a lot of algae, while other streams do not. We think that the presence of algae might be linked to trout in some way...so we ask the following question:

**Does algal biomass differ in Sierra Nevada streams with invasive trout and without invasive trout?**

As curious scientists, we decide to do a proper scientific experiment. We choose fifty streams with fish, and fifty streams without fish, and we measure the algae levels in all of the streams. Here are the data from the first five streams of each type:

```{r algae_data1}

head(algae[algae$stream_type == 'fish',], 5)

head(algae[algae$stream_type == 'fishless',], 5)

```

Looking at our data, it *seems* like there might be more algae in streams with fish. But how can we determine whether this is a real pattern, or something that's due to random chance?

This is where **statistics** are useful! Statistics can tell us how likely it is that our results were just due to random chance, instead of representing an actual pattern in the data.

What does random chance mean?

### How do we do the "statistics"?

There are several types of statistics that are widely used...we're going to be using **hypothesis testing** methods in this class.

Hypothesis testing involves the following procedure:

1. Identify what question you are asking. What do you want to know? Develop an original hypothesis.
2. Collect data to test your hypothesis
3. Construct null (H~0~) and alternative (H~A~) hypotheses
4. Use the appropriate statistical test to examine your hypotheses
5. State your conclusions in terms of your original question

Let's try it, using our algae data!

### 1. State a question and make a hypothesis (claim)

Write your hypothesis as an if/then statement here:

And write a reason for your hypothesis here:

### 2. Collect data

We already did this! But let's think about the data we collected. 

```{r algae_data2}

head(algae[algae$stream_type == 'fish',], 5)

head(algae[algae$stream_type == 'fishless',], 5)

```

Types of data

Predictor/independent variable (factor)
Fish (two levels: Fish and Fishless)

Response/dependent variable
Algal biomass

Additional variables


### 3. Create H~0~ and H~A~

These are special statistical hypotheses...they're sort of like two sides of the hypothesis coin.

H~0~ : The hypothesis of no difference

H~A~ : The hypothesis of difference

### 4. Use a statistical test

### 5. State your conclusions




### Assumptions

Randomly chosen
Replicated

What kind of data do I have (categorical, binary, continuous)?


Do I want to know about the mean, median, or variance of my data?


Does my data follow a normal distribution?


## t-tests

## ANOVA


```{r}


algae_anova <- aov(algal_biomass ~ stream_type, data = algae)
summary(algae_anova)

TukeyHSD(algae_anova)


```


```{r}

# Calculate mean evenness for each treatment

algae %>% 
  group_by(stream_type) %>% 
  summarise(
    mean = mean(algal_biomass),
    sd = sd(algal_biomass)
  )

# Explore the data distribution

algae <- filter(algae, stream_type != 'declining')

ggplot(algae, aes(x = algal_biomass,
                  fill = stream_type)) +
  geom_histogram(bins = 15) +
  geom_density(alpha = 0.5) +
  scale_fill_manual(name = 'Stream Type',
                    values = c('blue','green'),
                    labels = c('Trout','No trout')) +
  scale_y_continuous(expand = c(0,0)) +
  theme_classic() +
  facet_wrap(~stream_type) +
  labs(x = "Algal Biomass (mg/L)",
       y ="Frequency")

t.test(algae$algal_biomass~algae$stream_type)


```

## Summary

